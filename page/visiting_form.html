<!DOCTYPE html>
<html lang="ko">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=0,maximum-scale=10,user-scalable=yes">
		<title>초기방문신청 정보 작성</title>
		<!--<link rel="stylesheet" type="text/css" href="../css/normalize.css">-->
		<link rel="stylesheet" type="text/css" href="../css/font.css">
		<link rel="stylesheet" href="https://unicons.iconscout.com/release/v3.0.6/css/line.css">
		<link rel="stylesheet" type="text/css" href="../css/common.css">
		<script type="text/javascript" src="../js/jquery-3.5.1.min.js"></script>
		<script type="text/javascript" src="../js/nlobby_script.js"></script>
	</head>
	<body>
		<div id="wrap">
			<header>
				<h1 class="title_line">방문신청 정보 작성</h1>
			</header>
			<div id="content">
				<div class="gray_bg">
					<div class="agreement_area">
						<div class="agreement">
							<h2 class="header_line">이용약관 동의</h2>
							<div class="check_box">
								<button class="con_btn">전체동의</button>
								<div class="check_form">
									<input type="checkbox" id="provision1" name="check_input" class="check_input">
									<label for="provision1">엔로비 이용약관 동의 (필수)<a href="#"><i class="uil uil-angle-right"></i></a></label>
									<input type="checkbox" id="provision2" name="check_input" class="check_input">
									<label for="provision2">엔로비 개인정보 처리방침 (필수)<a href="#"><i class="uil uil-angle-right"></i></a></label>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="apply_area">
					<div class="apply_info">
						<h2 class="header_line">방문정보 작성</h2>
						<p class="sub_title">엔로비 이용고객사에 방문신청 하실 경우 자동으로 입력됩니다.<br>
							<span class="t_mini">입력하신 정보는 스마트폰에 저장되며 서버로 전송되지 않습니다.</span>
						</p>
						<div class="apply_form">
							<form name="frm1">
								<label class="red_form form_label name_label">
									<span class="form_title">이름</span>
									<input type="text" name="name" class="name form" placeholder="이름 입력" required />
									<button class="txt_clear btn">지우기</button>
								</label>
								<p class="error_m name_error">이름을 입력해주세요.</p>
								<label class="red_form form_label company_label">
									<span class="form_title">소속회사</span>
									<input type="text" name="company" class="company form" placeholder="소속회사 입력" required/>
									<button class="txt_clear btn">지우기</button>
								</label>
								<p class="error_m company_error">소속회사를 입력해주세요.</p>
								<label class="red_form form_label duty_label">
									<span class="form_title">직책</span>
									<input type="text" name="duty" class="duty form" placeholder="예) 사원 / 주임 / 대리 / 과장" required/>
									<button class="txt_clear btn">지우기</button>
								</label>
								<p class="error_m duty_error">직책을 입력해주세요.</p>
								<label class="red_form form_label phone_label">
									<span class="form_title">휴대전화번호</span>
									<input type="tel" name="phone" class="phone form" placeholder="예) 01012341234" required/>
									<button class="txt_clear btn">지우기</button>
								</label>
								<p class="error_m phone_error">휴대전화번호를 입력해주세요.</p>
								<label class="free_form form_label car_label">
									<span class="form_title">차량번호</span>
									<input type="text" name="car_num" class="car_num form" placeholder="예) 123가1234"/>
									<button class="txt_clear btn">지우기</button>
								</label>
								<label class="free_form form_label">
									<span class="form_title">이메일</span>
									<input type="email" name="email" class="email form" placeholder="예) abc@abcdefg.com"/>
									<button class="txt_clear btn">지우기</button>
								</label>
							</form>
						</div>
					</div>
				</div>
			</div>
			<div id="footer_btn">
				<button id="complet_btn" class="btn">작성완료</button>
				<!--
				<button onclick="location.href='visiting_complete.html'" id="completed_btn" class="btn">작성완료</button>
				-->
				<button  onclick="check_onclick();" id="completed_btn" class="btn">작성완료</button>
			</div>
		</div>
		<script>
			var check_form = document.querySelector('.check_form');
			var inputs = [...check_form.children];
			var allBtn = document.querySelector('.con_btn');

			allBtn.onclick = () => {
				if (inputs.filter(input => input.checked).length === inputs.length) {
					inputs.forEach(input => {input.checked = false; });
					$('.con_btn').removeClass('checked');
					$('#complet_btn').css('display','block');
					$('#completed_btn').css('display','none');
				} else {
					inputs.forEach(input => {input.checked = true; });
					$('.con_btn').addClass('checked');
					$('#complet_btn').css('display','none');
					$('#completed_btn').css('display','block');
				}
			};


			var validityMessage = {
				badInput: '잘못된 입력입니다',
				patternMismatch: '_patternMismatch',
				rangeOverflow: '_rangeOverflow',
				rangeUnderflow: '_rangeUnderflow',
				stepMismatch: '_stepMismatch',
				tooLong: '_tooLong',
				tooShort: '6자 이상 입력하세요',
				typeMismatch: '이메일 주소 형식으로 입력하세요',
				valueMissing: '',
			}

			function getMessage(validity) {
				for (var key in validityMessage) {
					if (validity[key]) {
						return validityMessage[key]
					}
				}
			}

			function showError(input) {
				// 오류 메시지 스타일 
				document.querySelector('.error_m').textContent = getMessage(input.validity)
			}

			function onload() {
				document.querySelectorAll('input').forEach(input => {
					input.addEventListener('invalid', (e) => {
						document.forms[0].classList.add('was-validated');
						showError(input)
						/**
						* 브라우져 툴팁 숨김 
						*/ 
						e.preventDefault();
					});

					input.addEventListener('input', () => {
					// 검증 후에 오류 메세지 표시 
						if (document.forms[0].classList.contains('was-validated')) {
							input.reportValidity()
						};
					});
				});
			};

			document.addEventListener('DOMContentLoaded', onload)



			function check_onclick(){
				theForm=document.frm1;
				if(theForm.name.value==""){
					$(".name_error").css("display","block");
					return theForm.name.focus();
				} else {
					$(".name_error").css("display","none");
				}
				if(theForm.company.value==""){
					$(".company_error").css("display","block");
					return theForm.company.focus();
				} else {
					$(".company_error").css("display","none");
				}
				if(theForm.duty.value==""){
					$(".duty_error").css("display","block");
					return theForm.duty.focus();
				} else {
					$(".duty_error").css("display","none");
				}
				if(theForm.phone.value==""){
					$(".phone_error").css("display","block");
					return theForm.phone.focus();
				} else {
					$(".phone_error").css("display","none");
				}
				// 작성이 완료되면 작성완료 페이지 이동
				location.href=('visiting_complete.html');
			}

		</script>
	</body>
</html>